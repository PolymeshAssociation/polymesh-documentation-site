<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-settlement/settlement-app">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Settlement Example App | Polymesh Documentation Portal</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://polymeshassociation.github.io/polymesh-documentation-site/docs/settlement/example-app/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Settlement Example App | Polymesh Documentation Portal"><meta data-rh="true" name="description" content="A walk through the example app"><meta data-rh="true" property="og:description" content="A walk through the example app"><link data-rh="true" rel="icon" href="/polymesh-documentation-site/img/polymesh-symbol.svg"><link data-rh="true" rel="canonical" href="https://polymeshassociation.github.io/polymesh-documentation-site/docs/settlement/example-app/"><link data-rh="true" rel="alternate" href="https://polymeshassociation.github.io/polymesh-documentation-site/docs/settlement/example-app/" hreflang="en"><link data-rh="true" rel="alternate" href="https://polymeshassociation.github.io/polymesh-documentation-site/docs/settlement/example-app/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://K25SRS7O1D-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Polymesh Documentation Portal" href="/polymesh-documentation-site/opensearch.xml"><link rel="stylesheet" href="/polymesh-documentation-site/assets/css/styles.cf6c6367.css">
<link rel="preload" href="/polymesh-documentation-site/assets/js/runtime~main.a0a5eb3d.js" as="script">
<link rel="preload" href="/polymesh-documentation-site/assets/js/main.09988d0e.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/polymesh-documentation-site/"><div class="navbar__logo"><img src="/polymesh-documentation-site/img/logo.svg" alt="Polymesh Logo" class="themedImage_ToTc themedImage--light_HNdA" width="150px"><img src="/polymesh-documentation-site/img/logo.svg" alt="Polymesh Logo" class="themedImage_ToTc themedImage--dark_i4oU" width="150px"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/polymesh-documentation-site/docs/">Developer Docs</a><a class="navbar__item navbar__link" href="/polymesh-documentation-site/polymesh-docs/">Polymesh Docs</a><a class="navbar__item navbar__link" href="/polymesh-documentation-site/sdk-docs/">SDK API Docs</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/polymesh-documentation-site/sdk-docs/">19.0.0</a><ul class="dropdown__menu"><li><div>SDK Docs Version</div></li><li><a class="dropdown__link" href="/polymesh-documentation-site/sdk-docs/">19.0.0</a></li></ul></div><a href="https://docs.polymesh.live/polymesh/index.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Polymesh Rust Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/PolymeshAssociation" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/polymesh-documentation-site/docs/">Welcome to the Polymesh Documentation Site!</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/polymesh-documentation-site/docs/introduction/">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/polymesh-documentation-site/docs/quickstart/up-in-ten-minutes/">Quick Start</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/polymesh-documentation-site/docs/originate/creating-asset/">Originate an Asset</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/polymesh-documentation-site/docs/distribute/distributing-assets/">Distributing an Assets</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/polymesh-documentation-site/docs/settlement/transferring-assets/">Settlement</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/polymesh-documentation-site/docs/settlement/transferring-assets/">Transferring Assets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/polymesh-documentation-site/docs/settlement/settlement-process/">Settlement Process</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/polymesh-documentation-site/docs/settlement/with-dashboard/">Polymesh App Portal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/polymesh-documentation-site/docs/settlement/settlement-agents/">External Agents</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/polymesh-documentation-site/docs/settlement/sdk/">With the SDK</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/polymesh-documentation-site/docs/settlement/example-app/">Settlement Example App</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/polymesh-documentation-site/docs/actions/">Corporate Actions</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/polymesh-documentation-site/docs/kyc/kyc/">KYC and CDD on Polymesh</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/polymesh-documentation-site/docs/resources/github-repositories/">Resources</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/polymesh-documentation-site/docs/community/">Community</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/polymesh-documentation-site/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Settlement</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Settlement Example App</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Settlement Example App</h1></header><p>After learning about the SDK elements that work for settlement and custodianship, let&#x27;s have a look at a simplified example of what it would take to integrate an existing system with Polymesh. For this example, we will consider the case of a stock exchange onto which brokers place orders for their customers. To simplify, and not overburden the reader with elements not relevant to learning about Polymesh, we did not add any authentication nor authorisation mechanism. Nor did we implement any sophisticated order matching algorithm.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pre-polymesh">Pre Polymesh<a href="#pre-polymesh" class="hash-link" aria-label="Direct link to Pre Polymesh" title="Direct link to Pre Polymesh">​</a></h2><p>Let&#x27;s describe the simple exchange system before we integrate it with Polymesh.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-setup">The setup<a href="#the-setup" class="hash-link" aria-label="Direct link to The setup" title="Direct link to The setup">​</a></h3><p><strong>4 pages</strong> are served:</p><ul><li><code>index.tsx</code>, a <a href="https://github.com/PolymeshAssociation/technical-content-examples/blob/e39d5f7ccb7518eef82c347d24a2efcb287dfd53/settlement_provider/pages/index.tsx" target="_blank" rel="noopener noreferrer">page to link</a> to the 3 others.</li><li><code>trader.tsx</code>, a <a href="https://github.com/PolymeshAssociation/technical-content-examples/blob/e39d5f7ccb7518eef82c347d24a2efcb287dfd53/settlement_provider/pages/trader.tsx" target="_blank" rel="noopener noreferrer">page for traders and custodians</a> to see, put and delete orders.</li><li><code>exchange.tsx</code>, a <a href="https://github.com/PolymeshAssociation/technical-content-examples/blob/e39d5f7ccb7518eef82c347d24a2efcb287dfd53/settlement_provider/pages/exchange.tsx" target="_blank" rel="noopener noreferrer">page for the exchange &quot;manager&quot;</a> to see all orders in 2 columns, and match 1 sell order with 1 buy order and thereby create 1 trade.</li><li><code>custodian.tsx</code>, a <a href="https://github.com/PolymeshAssociation/technical-content-examples/blob/e39d5f7ccb7518eef82c347d24a2efcb287dfd53/settlement_provider/pages/custodian.tsx" target="_blank" rel="noopener noreferrer">page for the traders and custodians</a> to see their trades&#x27; pending settlements and indicate the actions they have taken.</li></ul><p>There is a rudimentary server that exposes a <strong>simple API</strong>:</p><ul><li><code>api/trader/[id].ts</code>, an <a href="https://github.com/PolymeshAssociation/technical-content-examples/blob/e39d5f7ccb7518eef82c347d24a2efcb287dfd53/settlement_provider/pages/api/trader/%5Bid%5D.ts" target="_blank" rel="noopener noreferrer">end point</a> for traders and custodians to get, put and delete orders. Orders are identified by their <a href="https://github.com/PolymeshAssociation/technical-content-examples/blob/e39d5f7ccb7518eef82c347d24a2efcb287dfd53/settlement_provider/pages/api/trader/%5Bid%5D.ts#L18" target="_blank" rel="noopener noreferrer"><code>id</code></a>, and no restriction is enforced here. Anyone can use any <code>id</code>, including <em>someone else&#x27;s</em>.</li><li><code>api/trades.ts</code>, an <a href="https://github.com/PolymeshAssociation/technical-content-examples/blob/e39d5f7ccb7518eef82c347d24a2efcb287dfd53/settlement_provider/pages/api/trades.ts" target="_blank" rel="noopener noreferrer">end point</a> for anyone to retrieve all trades. This is used by the <code>exchange.tsx</code> page to be able to present the buy and sell orders.</li><li><code>api/settlements.ts</code>, an <a href="https://github.com/PolymeshAssociation/technical-content-examples/blob/e39d5f7ccb7518eef82c347d24a2efcb287dfd53/settlement_provider/pages/api/settlements.ts" target="_blank" rel="noopener noreferrer">end point</a> for:<ul><li>the exchange to post matching orders, thereby creating a pending settlement.</li><li>the traders and custodians to get all relevant pending settlements.</li></ul></li><li><code>api/settlement/[id].ts</code>, an <a href="https://github.com/PolymeshAssociation/technical-content-examples/blob/e39d5f7ccb7518eef82c347d24a2efcb287dfd53/settlement_provider/pages/api/settlement/%5Bid%5D.ts" target="_blank" rel="noopener noreferrer">end point</a> place for traders and custodians to get, patch and delete settlements. Settlements are identified by their <a href="https://github.com/PolymeshAssociation/technical-content-examples/blob/e39d5f7ccb7518eef82c347d24a2efcb287dfd53/settlement_provider/pages/api/settlement/%5Bid%5D.ts#L19" target="_blank" rel="noopener noreferrer"><code>id</code></a>, which is decided by the exchange server. When traders and custodians <em>patch</em> a settlement, that is to indicate whether they have paid / transferred their end of the bargain. Yes, there is no verification, it is based on trust...</li></ul><p>On the server, basic <strong>services</strong> are running:</p><ul><li><code>exchangeDbFs.ts</code>, a <a href="https://github.com/PolymeshAssociation/technical-content-examples/blob/e39d5f7ccb7518eef82c347d24a2efcb287dfd53/settlement_provider/src/exchangeDbFs.ts" target="_blank" rel="noopener noreferrer">service</a> to store orders from traders and custodians on disk in a large JSON file, instead of a proper database, for simplicity&#x27;s stake.</li><li><code>settlementDbFs.ts</code>, a similar <a href="https://github.com/PolymeshAssociation/technical-content-examples/blob/e39d5f7ccb7518eef82c347d24a2efcb287dfd53/settlement_provider/src/settlementDbFs.ts" target="_blank" rel="noopener noreferrer">service</a>, this time to store pending trade settlements, on disk in a large JSON file.</li></ul><p>The system describes its <strong>information</strong> in terms of:</p><ul><li><code>OrderInfo</code>, an <a href="https://github.com/PolymeshAssociation/technical-content-examples/blob/e39d5f7ccb7518eef82c347d24a2efcb287dfd53/settlement_provider/src/orderInfo.ts" target="_blank" rel="noopener noreferrer">object</a> to describe an order information.</li><li><code>AssignedOrderInfo</code>, <a href="https://github.com/PolymeshAssociation/technical-content-examples/blob/e39d5f7ccb7518eef82c347d24a2efcb287dfd53/settlement_provider/src/orderInfo.ts#L71" target="_blank" rel="noopener noreferrer">the same</a> but with an <code>id</code>. Note that this <code>id</code> serves as the identifier of the order. At the same time, because we do not have identifiers for traders, this <code>id</code> serves as an identifier for traders too, as can be seen in <code>SettlementParty</code> below. Of course, an entity can create multiple orders, just by picking an available <code>id</code>.</li><li><code>SettlementParty</code>, an <a href="https://github.com/PolymeshAssociation/technical-content-examples/blob/e39d5f7ccb7518eef82c347d24a2efcb287dfd53/settlement_provider/src/settlementInfo.ts#L55" target="_blank" rel="noopener noreferrer">object</a> to describe a party involved in a trade. In effect, the <code>id</code> of the order / trader.</li><li><code>SettlementInfo</code>, an <a href="https://github.com/PolymeshAssociation/technical-content-examples/blob/e39d5f7ccb7518eef82c347d24a2efcb287dfd53/settlement_provider/src/settlementInfo.ts#L70" target="_blank" rel="noopener noreferrer">object</a> to describe the result of matched orders.</li><li><code>FullSettlementInfo</code>, <a href="https://github.com/PolymeshAssociation/technical-content-examples/blob/e39d5f7ccb7518eef82c347d24a2efcb287dfd53/settlement_provider/src/settlementInfo.ts#L123" target="_blank" rel="noopener noreferrer">the same</a> but with an <code>id</code>.</li></ul><p>There are a couple of extra <strong>functions</strong> to note:</p><ul><li>a <code>createByMatchingOrders</code> <a href="https://github.com/PolymeshAssociation/technical-content-examples/blob/e39d5f7ccb7518eef82c347d24a2efcb287dfd53/settlement_provider/src/settlementInfo.ts#L141" target="_blank" rel="noopener noreferrer">function</a> to assist in creating a <code>SettlementInfo</code> out of 2 matching <code>OrderInfo</code>.</li><li>a more complex <code>matchOrders</code> <a href="https://github.com/PolymeshAssociation/technical-content-examples/blob/e39d5f7ccb7518eef82c347d24a2efcb287dfd53/settlement_provider/pages/api/settlements.ts#L46" target="_blank" rel="noopener noreferrer">function</a> that assists in saving the created settlement into the server, and updating or deleting the orders.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-it-looks">How it looks<a href="#how-it-looks" class="hash-link" aria-label="Direct link to How it looks" title="Direct link to How it looks">​</a></h3><p>Let&#x27;s say that trader 1 puts a buy order and trader 3 puts a sell order:</p><p><img loading="lazy" alt="Buy order" src="/polymesh-documentation-site/assets/images/app-order-submitted-1-736318a5345032a02df66009d9cfc755.png" width="409" height="622" class="img_ev3q">
<img loading="lazy" alt="Sell order" src="/polymesh-documentation-site/assets/images/app-order-submitted-2-6bf0df441c8bc67d5c4ad3385851f328.png" width="417" height="627" class="img_ev3q"></p><p>Then, when the exchange looks at the current orders:</p><p><img loading="lazy" alt="Exchange selection" src="/polymesh-documentation-site/assets/images/app-exchange-selection-612b79efbf1abf1e0e5e0d8e99747ff4.png" width="652" height="450" class="img_ev3q"></p><p>Then after clicking <kbd>Submit the match</kbd>:</p><p><img loading="lazy" alt="Exchange after match" src="/polymesh-documentation-site/assets/images/app-exchange-remaining-orders-9292649890e207abea70e1dec0c61269.png" width="655" height="452" class="img_ev3q"></p><p>So 50 shares of ACME have been traded for 35 USD apiece. It is time to see this settlement from the point of view of the trader 1, or its custodian:</p><p><img loading="lazy" alt="Settlement list" src="/polymesh-documentation-site/assets/images/app-update-settlement-1-9e34d40ede1f31dea3fe77a5b2f54365.png" width="650" height="718" class="img_ev3q"></p><p>Trader 1 was the buyer, so it needs to click <kbd>Mark as paid</kbd> when it has been done. Since the trade is about 2 parties, the seller also needs to accept, so let&#x27;s look at it from the seller&#x27;s point of view:</p><p><img loading="lazy" alt="Settlement list" src="/polymesh-documentation-site/assets/images/app-update-settlement-2-2e3e22ca02b740e66ca226fe9be5c5d7.png" width="648" height="715" class="img_ev3q"></p><p>After clicking <kbd>Mark as transferred</kbd>, the trade is considered complete. Of course it is possible for either party to reject it.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="post-polymesh">Post Polymesh<a href="#post-polymesh" class="hash-link" aria-label="Direct link to Post Polymesh" title="Direct link to Post Polymesh">​</a></h2><p>Time to integrate with Polymesh. What needs to be done?</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-setup-1">The setup<a href="#the-setup-1" class="hash-link" aria-label="Direct link to The setup" title="Direct link to The setup">​</a></h3><p>Let&#x27;s go from the bottom up.</p><p>On the <strong>configuration</strong>:</p><ul><li>Some <a href="https://github.com/PolymeshAssociation/technical-content-examples/pull/1/files?file-filters%5B%5D=.js&amp;file-filters%5B%5D=.json&amp;file-filters%5B%5D=.sample#diff-c02f974584446105260153bd0ce8441ad09837cd11da994487935e8855dd4660R2" target="_blank" rel="noopener noreferrer">basic information</a> is added about the exchange server&#x27;s Polymesh account mnemonic, and the default settlement venue of the exchange.</li><li>A <a href="https://github.com/PolymeshAssociation/technical-content-examples/pull/1/files?file-filters%5B%5D=.js&amp;file-filters%5B%5D=.json&amp;file-filters%5B%5D=.sample&amp;file-filters%5B%5D=.ts#diff-c4e3b091eb7f86c0e60297f2f061ae3855a16a0f58fee93f83efbd0feadc1b9dR66" target="_blank" rel="noopener noreferrer">CLI tool</a> is added to handle the setup in a more pleasant way.</li></ul><p>On <strong>objects</strong>:</p><ul><li>in <code>OrderInfo</code>, we <a href="https://github.com/PolymeshAssociation/technical-content-examples/pull/1/files?file-filters%5B%5D=.js&amp;file-filters%5B%5D=.json&amp;file-filters%5B%5D=.sample&amp;file-filters%5B%5D=.ts#diff-139262810d921a125869827f871972dbdaffa7d018d28628ce220bfa431ff97dR47" target="_blank" rel="noopener noreferrer">add information</a> about the trader&#x27;s trading portfolio.</li><li>in <code>SettlementParty</code>, we <a href="https://github.com/PolymeshAssociation/technical-content-examples/pull/1/files?file-filters%5B%5D=.js&amp;file-filters%5B%5D=.json&amp;file-filters%5B%5D=.sample&amp;file-filters%5B%5D=.ts#diff-5321a5cd63f4b879cfed01d486209d7578a49bb86db4962f29533b011466b5a1R81" target="_blank" rel="noopener noreferrer">add the same information</a> about the trader.</li><li>In <code>SettlementInfo</code>, we <a href="https://github.com/PolymeshAssociation/technical-content-examples/pull/1/files?file-filters%5B%5D=.js&amp;file-filters%5B%5D=.json&amp;file-filters%5B%5D=.sample&amp;file-filters%5B%5D=.ts#diff-5321a5cd63f4b879cfed01d486209d7578a49bb86db4962f29533b011466b5a1R173" target="_blank" rel="noopener noreferrer">add a way to reference</a> a settlement instruction.</li></ul><p>On <strong>services</strong>:</p><ul><li>in <code>exchangeDbFs</code>, we <a href="https://github.com/PolymeshAssociation/technical-content-examples/pull/1/files?file-filters%5B%5D=.js&amp;file-filters%5B%5D=.json&amp;file-filters%5B%5D=.sample&amp;file-filters%5B%5D=.ts#diff-2be3b086a47575a9f2740491f2f04fa2f3062144edc06c048697c5ab83d9dfd4R60-R71" target="_blank" rel="noopener noreferrer">add a way to check</a> that the Polymesh information is valid.</li><li>which means the <code>exchangeDbFactory</code> needs to be <a href="https://github.com/PolymeshAssociation/technical-content-examples/pull/1/files?file-filters%5B%5D=.js&amp;file-filters%5B%5D=.json&amp;file-filters%5B%5D=.sample&amp;file-filters%5B%5D=.ts#diff-4b54886f30e846be914baa6778d2764108ac257ed442141033ada85893132477R30-R33" target="_blank" rel="noopener noreferrer">adjusted to prepare</a> the Polymesh API.</li><li>we also add a new service <code>SettlementEnginePoly</code>, which handles the <a href="https://github.com/PolymeshAssociation/technical-content-examples/pull/1/files?file-filters%5B%5D=.js&amp;file-filters%5B%5D=.json&amp;file-filters%5B%5D=.sample&amp;file-filters%5B%5D=.ts#diff-24961064d7f42bad3e6fa973ebcae0e74232d8a0719fe6b1a6e5778e863c6252R21" target="_blank" rel="noopener noreferrer">publication of the settlement instruction</a> on Polymesh.</li></ul><p>On <strong>API end points</strong>:</p><ul><li>No real changes other than using the right types and exceptions.</li></ul><p>On <strong>pages</strong>:</p><ul><li>We add a <a href="https://github.com/PolymeshAssociation/technical-content-examples/pull/1/files?file-filters%5B%5D=.js&amp;file-filters%5B%5D=.json&amp;file-filters%5B%5D=.sample&amp;file-filters%5B%5D=.ts#diff-85febf1f1ae8f654850ed7c8b0b2be73b0dac205622a3cd1ead6496dcec3fb51R5" target="_blank" rel="noopener noreferrer">helper</a> to get the Polywallet.</li><li>On the trader page, we make it possible to also <a href="https://github.com/PolymeshAssociation/technical-content-examples/pull/1/files?file-filters%5B%5D=.js&amp;file-filters%5B%5D=.json&amp;file-filters%5B%5D=.sample&amp;file-filters%5B%5D=.tsx#diff-2cad680e168ccf5ac7a8167930436c212eea1f0d3ca879fcf365ba6141fda451R28-R40" target="_blank" rel="noopener noreferrer">pick custodied portfolios</a>, so that custodians can choose them.</li><li>We also make it possible for the trader to <a href="https://github.com/PolymeshAssociation/technical-content-examples/pull/1/files?file-filters%5B%5D=.js&amp;file-filters%5B%5D=.json&amp;file-filters%5B%5D=.sample&amp;file-filters%5B%5D=.tsx#diff-2cad680e168ccf5ac7a8167930436c212eea1f0d3ca879fcf365ba6141fda451R259" target="_blank" rel="noopener noreferrer">set a custodian</a> on a given portfolio.</li><li>Because of that, we also add a way to <a href="https://github.com/PolymeshAssociation/technical-content-examples/pull/1/files?file-filters%5B%5D=.js&amp;file-filters%5B%5D=.json&amp;file-filters%5B%5D=.sample&amp;file-filters%5B%5D=.tsx#diff-2cad680e168ccf5ac7a8167930436c212eea1f0d3ca879fcf365ba6141fda451R370" target="_blank" rel="noopener noreferrer">show the incoming requests</a>.</li><li>The exchange page does <a href="https://github.com/PolymeshAssociation/technical-content-examples/pull/1/files?file-filters%5B%5D=.js&amp;file-filters%5B%5D=.json&amp;file-filters%5B%5D=.sample&amp;file-filters%5B%5D=.tsx#diff-c4a93796c437e7b23414b654abb3b87a80b1508cf9a0236c7968c20d855cb6d4R65" target="_blank" rel="noopener noreferrer">not really change</a>.</li><li>The custodian settlement page adds a way to <a href="https://github.com/PolymeshAssociation/technical-content-examples/pull/1/files?file-filters%5B%5D=.js&amp;file-filters%5B%5D=.json&amp;file-filters%5B%5D=.sample&amp;file-filters%5B%5D=.tsx#diff-dd0746cede6c07a074e2e78bb5be1b1b45e7927ce3a1269822c4057e0af03923R163" target="_blank" rel="noopener noreferrer">load instructions</a> that are in the exchange venue but are not part of what the exchange knows about.</li><li>Additionally, the custodian page <a href="https://github.com/PolymeshAssociation/technical-content-examples/pull/1/files?file-filters%5B%5D=.js&amp;file-filters%5B%5D=.json&amp;file-filters%5B%5D=.sample&amp;file-filters%5B%5D=.tsx#diff-dd0746cede6c07a074e2e78bb5be1b1b45e7927ce3a1269822c4057e0af03923R215" target="_blank" rel="noopener noreferrer">affirms the relevant legs</a>, before informing the exchange server that a trade side has been paid or transferred.</li><li>Of course, the custodian page needs to check the identity found in the Polywallet and activate the buttons only when the affirmation is possible.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-it-looks-1">How it looks<a href="#how-it-looks-1" class="hash-link" aria-label="Direct link to How it looks" title="Direct link to How it looks">​</a></h3><p>There is more information to provide when submitting a buy order:</p><p><img loading="lazy" alt="Order submitted" src="/polymesh-documentation-site/assets/images/app-order-submitted-poly-1-ac0c767f55125499bd86edae97e7cb55.png" width="639" height="1280" class="img_ev3q"></p><p>And a sell order:</p><p><img loading="lazy" alt="Order submitted" src="/polymesh-documentation-site/assets/images/app-order-submitted-poly-2-b28ca39a652873ee415b5691a25801cd.png" width="622" height="1234" class="img_ev3q"></p><p>The exchange page did not change. The custodian settlement page has more too:</p><p><img loading="lazy" alt="Settlement page" src="/polymesh-documentation-site/assets/images/app-update-settlement-poly-1-098c8abf266002ff4f53d05a6f2bb097.png" width="690" height="1097" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2><p>That&#x27;s what it takes.</p><ul><li>Make your server able to access Polymesh.</li><li>Store a bit more information in your database.</li><li>Make your Web pages a bit more decentralised by having them:<ul><li>trust the exchange server but verify.</li><li>do some actions that do not involve the exchange server.</li></ul></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/PolymeshAssociation/polymesh-documentation-site/edit/develop/docs/05-settlement/settlement-app.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/polymesh-documentation-site/docs/settlement/sdk/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">With the SDK</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/polymesh-documentation-site/docs/actions/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Executing Actions</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#pre-polymesh" class="table-of-contents__link toc-highlight">Pre Polymesh</a><ul><li><a href="#the-setup" class="table-of-contents__link toc-highlight">The setup</a></li><li><a href="#how-it-looks" class="table-of-contents__link toc-highlight">How it looks</a></li></ul></li><li><a href="#post-polymesh" class="table-of-contents__link toc-highlight">Post Polymesh</a><ul><li><a href="#the-setup-1" class="table-of-contents__link toc-highlight">The setup</a></li><li><a href="#how-it-looks-1" class="table-of-contents__link toc-highlight">How it looks</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/polymesh-documentation-site/docs/introduction/">Developer Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/polymesh-documentation-site/polymesh-docs/#network">Network Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/polymesh-documentation-site/polymesh-docs/#primitives">Polymesh Primitive Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/ud2deWAnyt" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/PolymeshNetwork" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/polymeshnetwork/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/c/PolymeshNetwork" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://polymesh.network/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Polymesh Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://polymesh.network/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/PolymeshAssociation" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://polymesh.network/contact-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact Us<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/polymesh-documentation-site/img/logo.svg" alt="Polymesh Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo" width="150px"><img src="/polymesh-documentation-site/img/logo.svg" alt="Polymesh Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo" width="150px"></div><div class="footer__copyright">Copyright © 2023 Polymesh Association, All Right Reserved</div></div></div></footer></div>
<script src="/polymesh-documentation-site/assets/js/runtime~main.a0a5eb3d.js"></script>
<script src="/polymesh-documentation-site/assets/js/main.09988d0e.js"></script>
</body>
</html>