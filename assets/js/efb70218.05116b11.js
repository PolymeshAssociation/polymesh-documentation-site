"use strict";(self.webpackChunkpolymesh_developer_documentation=self.webpackChunkpolymesh_developer_documentation||[]).push([[65498],{73420:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"core-concepts/identity/advanced/multisig/multisigs","title":"Multisigs","description":"Create multi-signature structures requiring approval from multiple parties","source":"@site/docs/200-core-concepts/030-identity/030-advanced/020-multisig/index.md","sourceDirName":"200-core-concepts/030-identity/030-advanced/020-multisig","slug":"/identity/advanced/multisig","permalink":"/polymesh-documentation-site/identity/advanced/multisig","draft":false,"unlisted":false,"editUrl":"https://github.com/PolymeshAssociation/polymesh-documentation-site/edit/develop/docs/200-core-concepts/030-identity/030-advanced/020-multisig/index.md","tags":[{"inline":true,"label":"multisig","permalink":"/polymesh-documentation-site/tags/multisig"},{"inline":true,"label":"accounts","permalink":"/polymesh-documentation-site/tags/accounts"}],"version":"current","frontMatter":{"title":"Multisigs","description":"Create multi-signature structures requiring approval from multiple parties","id":"multisigs","slug":"/identity/advanced/multisig","sidebar_label":"Multisigs","tags":["multisig","accounts"]},"sidebar":"docs","previous":{"title":"Secondary Keys","permalink":"/polymesh-documentation-site/identity/advanced/secondary-keys"},"next":{"title":"Multisig Walkthrough","permalink":"/polymesh-documentation-site/identity/advanced/multisig/walkthrough"}}');var t=n(74848),a=n(28453);const r={title:"Multisigs",description:"Create multi-signature structures requiring approval from multiple parties",id:"multisigs",slug:"/identity/advanced/multisig",sidebar_label:"Multisigs",tags:["multisig","accounts"]},o=void 0,l={},d=[{value:"Overview",id:"overview",level:2},{value:"Core Concepts",id:"core-concepts",level:2},{value:"Structure and Roles",id:"structure-and-roles",level:3},{value:"Key Relationships",id:"key-relationships",level:3},{value:"Operational Flow",id:"operational-flow",level:3},{value:"Managing a Multisig",id:"managing-a-multisig",level:2},{value:"Creation and Setup",id:"creation-and-setup",level:3},{value:"Administration",id:"administration",level:3},{value:"Configuration changes",id:"configuration-changes",level:3},{value:"Adding/Removing Signers",id:"addingremoving-signers",level:4},{value:"Changing Required Signatures",id:"changing-required-signatures",level:4},{value:"Payment Management",id:"payment-management",level:3},{value:"Joining a New Identity",id:"joining-a-new-identity",level:3},{value:"Multisig Proposals",id:"multisig-proposals",level:2},{value:"Proposal Creation",id:"proposal-creation",level:3},{value:"Proposal Voting",id:"proposal-voting",level:3},{value:"Proposal Management",id:"proposal-management",level:3},{value:"Proposal States",id:"proposal-states",level:4}];function c(e){const i={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(i.p,{children:"A multisig in Polymesh is a specialized account that requires approval from multiple parties to execute transactions. Instead of using a single private key, a multisig allows you to specify a group of signing accounts (m signers) and define how many of those signers (n signatures) must agree before any transaction can be executed. On Polymesh, multisig keys behave the same as other key types, i.e., they can be associated with an identity as either a primary or secondary key with defined permissions."}),"\n",(0,t.jsx)(i.p,{children:"Multisigs enhance security and governance by distributing control across multiple parties while maintaining a single point of identity on the blockchain."}),"\n",(0,t.jsx)(i.h2,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,t.jsx)(i.h3,{id:"structure-and-roles",children:"Structure and Roles"}),"\n",(0,t.jsx)(i.p,{children:"A multisig consists of several key components:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Signing Keys"}),": The accounts authorized to approve transactions (m signers)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Required Signatures"}),": The minimum number of approvals needed (n signatures)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Admin Identity"}),": Optional identity that can manage multisig configuration"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Paying Identity"}),": The creator's identity, which pays for proposal transaction fees (can be removed)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Multisig Identity"}),": The identity to which the multisig is linked"]}),"\n"]}),"\n",(0,t.jsx)(i.h3,{id:"key-relationships",children:"Key Relationships"}),"\n",(0,t.jsx)(i.p,{children:"Multisigs have three important relationships:"}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Identity Association"}),": Like any key, a multisig must be linked to an identity to perform most operations"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Admin Control"}),": An optional admin identity can manage the multisig configuration"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Fee Payment"}),": Initially the creator's identity pays for proposal fees, but this can be removed to make the multisig self-paying"]}),"\n"]}),"\n",(0,t.jsx)(i.h3,{id:"operational-flow",children:"Operational Flow"}),"\n",(0,t.jsx)(i.p,{children:"The basic flow for multisig operations:"}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsx)(i.li,{children:"A signer proposes a transaction"}),"\n",(0,t.jsx)(i.li,{children:"Other signers review and approve/reject the proposal"}),"\n",(0,t.jsx)(i.li,{children:"When sufficient approvals are gathered, the transaction executes automatically"}),"\n",(0,t.jsx)(i.li,{children:"If rejected or executed, the proposal is removed from chain storage"}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"managing-a-multisig",children:"Managing a Multisig"}),"\n",(0,t.jsx)(i.h3,{id:"creation-and-setup",children:"Creation and Setup"}),"\n",(0,t.jsxs)(i.p,{children:["When a multisig is created by calling ",(0,t.jsx)(i.code,{children:"multisig::create_multisig"}),":"]}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsxs)(i.li,{children:["It's automatically added as a secondary key to the creator's identity. Optionally the creator can assign ",(0,t.jsx)(i.a,{href:"/identity/advanced/secondary-keys/#secondary-key-permissions",children:"secondary key permissions"})," to the multisig when creating."]}),"\n",(0,t.jsx)(i.li,{children:"The creator's identity becomes the paying identity"}),"\n",(0,t.jsx)(i.li,{children:"Authorization requests are sent to all designated signers"}),"\n",(0,t.jsx)(i.li,{children:"Signers must accept their authorizations before participating"}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"When selecting signing keys for a multisig consider the following requirements:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Signing keys cannot be linked to other identities or multisigs"}),"\n",(0,t.jsx)(i.li,{children:"Signers cannot directly receive or send POLYX"}),"\n"]}),"\n",(0,t.jsx)(i.h3,{id:"administration",children:"Administration"}),"\n",(0,t.jsxs)(i.p,{children:["A multisig can optionally have an admin identity that can unilaterally manage its configuration. An admin identity can be added by creating a multisig proposal with a call of ",(0,t.jsx)(i.code,{children:"multisig::add_admin"}),". The admin identity's primary key can then:"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Add a signer to the multisig (",(0,t.jsx)(i.code,{children:"multisig::add_multisig_signers_via_admin"}),")"]}),"\n",(0,t.jsxs)(i.li,{children:["Remove a signer from the multisig (",(0,t.jsx)(i.code,{children:"multisig::remove_multisig_signers_via_admin"}),")"]}),"\n",(0,t.jsxs)(i.li,{children:["Change the required number of signatures (",(0,t.jsx)(i.code,{children:"multisig::change_sigs_required_via_admin"}),")"]}),"\n"]}),"\n",(0,t.jsx)(i.admonition,{type:"note",children:(0,t.jsxs)(i.p,{children:["See ",(0,t.jsx)(i.a,{href:"#proposal-states",children:"Proposal Voting"})," for details on how configuration changes affect existing proposals."]})}),"\n",(0,t.jsx)(i.h3,{id:"configuration-changes",children:"Configuration changes"}),"\n",(0,t.jsxs)(i.p,{children:["If no admin identity is set (or as an alternative to admin-based changes), a multisig can modify its configuration through its normal ",(0,t.jsx)(i.a,{href:"#multisig-proposals",children:"proposal process"}),"."]}),"\n",(0,t.jsx)(i.p,{children:"The following configuration changes are possible:"}),"\n",(0,t.jsx)(i.h4,{id:"addingremoving-signers",children:"Adding/Removing Signers"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Add new signers via ",(0,t.jsx)(i.code,{children:"multisig::add_multisig_signers"})]}),"\n",(0,t.jsxs)(i.li,{children:["Remove existing signers via ",(0,t.jsx)(i.code,{children:"multisig::remove_multisig_signers"})]}),"\n"]}),"\n",(0,t.jsx)(i.admonition,{type:"note",children:(0,t.jsx)(i.p,{children:"You cannot remove signers if it would cause the total number of signers to fall below the required number of approvals"})}),"\n",(0,t.jsx)(i.h4,{id:"changing-required-signatures",children:"Changing Required Signatures"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Modify the number of required signatures via ",(0,t.jsx)(i.code,{children:"multisig::change_sigs_required"})]}),"\n",(0,t.jsxs)(i.li,{children:["The new required signatures value must be:","\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Greater than 0"}),"\n",(0,t.jsx)(i.li,{children:"Less than or equal to the total number of signers"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.h3,{id:"payment-management",children:"Payment Management"}),"\n",(0,t.jsx)(i.p,{children:"Transaction fees for multisig proposals are handled in one of two ways:"}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Paying Identity"}),": Initially set to the creator's identity, this identity's primary key covers transaction fees for all multisig proposals"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Self-Paying"}),": The multisig can be configured to pay its own fees by removing the paying identity"]}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"In either case, the paying key must have sufficient POLYX to submit and execute the transaction."}),"\n",(0,t.jsx)(i.p,{children:"Important points about the paying identity:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"It is automatically set to the creator's identity when the multisig is created"}),"\n",(0,t.jsxs)(i.li,{children:["It can be removed either by:","\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["The multisig itself using ",(0,t.jsx)(i.code,{children:"multisig::remove_payer"})]}),"\n",(0,t.jsxs)(i.li,{children:["The paying identity using ",(0,t.jsx)(i.code,{children:"multisig::remove_payer_via_payer"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.li,{children:"It cannot be changed to a different identity"}),"\n",(0,t.jsx)(i.li,{children:"Once removed, the multisig must pay its own transaction fees from its POLYX balance"}),"\n",(0,t.jsx)(i.li,{children:"The removal is permanent - after removing the paying identity, the multisig cannot revert to using a paying identity"}),"\n"]}),"\n",(0,t.jsx)(i.admonition,{type:"tip",children:(0,t.jsxs)(i.p,{children:["Once a paying identity has been removed, if another key is required to pay transaction fees, a ",(0,t.jsx)(i.a,{href:"/accounts/subsidized",children:"account subsidy"})," relationship can be set up."]})}),"\n",(0,t.jsx)(i.h3,{id:"joining-a-new-identity",children:"Joining a New Identity"}),"\n",(0,t.jsx)(i.p,{children:"When a multisig needs to move from one identity to another, there is a specific process that must be followed:"}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsxs)(i.li,{children:["The multisig must first leave its current identity using ",(0,t.jsx)(i.code,{children:"identity::leave_identity_as_key"})," as a proposal or be removed by the identities primary key."]}),"\n",(0,t.jsxs)(i.li,{children:["The new identity must issue then issue a ",(0,t.jsx)(i.code,{children:"JoinIdentity"})," authorization to the multisig"]}),"\n",(0,t.jsxs)(i.li,{children:["The multisig must accept this authorization using the specific extrinsic ",(0,t.jsx)(i.code,{children:"multisig::approve_join_identity"})]}),"\n"]}),"\n",(0,t.jsx)(i.admonition,{type:"important",children:(0,t.jsxs)(i.p,{children:["Multisigs must use ",(0,t.jsx)(i.code,{children:"multisig::approve_join_identity"})," instead of the standard ",(0,t.jsx)(i.code,{children:"identity::join_identity_as_key"})," when accepting a join identity authorization. This ensures transaction fees are handled correctly, as a multisig that is not attached to an identity cannot pay for its own transactions."]})}),"\n",(0,t.jsxs)(i.p,{children:["This process can be optimized by using Polymesh's batching functionality to combine leaving the current identity and joining the new identity into a single atomic transaction using ",(0,t.jsx)(i.code,{children:"utility::batch"}),". This approach is recommended when the ",(0,t.jsx)(i.code,{children:"JoinIdentity"})," authorization request can be obtained before the multisig needs to leave its current identity."]}),"\n",(0,t.jsx)(i.h2,{id:"multisig-proposals",children:"Multisig Proposals"}),"\n",(0,t.jsx)(i.h3,{id:"proposal-creation",children:"Proposal Creation"}),"\n",(0,t.jsxs)(i.p,{children:["To create a multisig proposal, a signer must call the ",(0,t.jsx)(i.code,{children:"multisig::create_proposal_as_key"})," extrinsic. This allows the proposer to wrap a standard blockchain call into a proposal that other multisig signers can vote on. The creator must be one of the authorized signers of the multisig, and by creating the proposal they automatically cast an approval vote."]}),"\n",(0,t.jsx)(i.p,{children:"When creating a proposal, you can specify:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"The transaction to be executed (wrapped as a proposal)"}),"\n",(0,t.jsx)(i.li,{children:"An optional expiry after which the proposal will expire if not executed"}),"\n",(0,t.jsx)(i.li,{children:"Arguments specific to the transaction being proposed"}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"Once created, proposals cannot be modified - they can only be approved or rejected by other signers. If enough signer threshold is reached during creation, the proposal will execute right away without requiring additional approvals."}),"\n",(0,t.jsx)(i.admonition,{type:"tip",children:(0,t.jsxs)(i.p,{children:["When using the Polymesh SDK, regular transactions from a multisig signer must use ",(0,t.jsx)(i.code,{children:".runAsProposal()"})," instead of ",(0,t.jsx)(i.code,{children:".run()"}),". The SDK will automatically wrap the transaction with ",(0,t.jsx)(i.code,{children:"multisig::create_proposal_as_key"}),". Proposal approvals/rejections by signers should still use ",(0,t.jsx)(i.code,{children:".run()"})," directly."]})}),"\n",(0,t.jsx)(i.h3,{id:"proposal-voting",children:"Proposal Voting"}),"\n",(0,t.jsxs)(i.p,{children:["Signers vote on proposals by calling either ",(0,t.jsx)(i.code,{children:"multisig::approve"})," or ",(0,t.jsx)(i.code,{children:"multisig::reject"}),", providing the multisig address and the proposal ID generated during the proposal creation as arguments. These transactions must be submitted directly by the signer's key, not through another multisig proposal."]}),"\n",(0,t.jsx)(i.p,{children:"Key voting aspects:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"The proposal creator's vote is automatically set to approve upon creation"}),"\n",(0,t.jsx)(i.li,{children:"Other signers can vote exactly once on each proposal"}),"\n",(0,t.jsxs)(i.li,{children:["The proposal creator has special privileges:","\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Can change their vote to reject if no other signers have voted yet"}),"\n",(0,t.jsx)(i.li,{children:"Changing to reject in this case automatically rejects the proposal"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.li,{children:"The proposal executes immediately when the required number of approvals is reached"}),"\n",(0,t.jsx)(i.li,{children:"A proposal is rejected when rejection votes exceed total signers minus required approvals"}),"\n"]}),"\n",(0,t.jsx)(i.h3,{id:"proposal-management",children:"Proposal Management"}),"\n",(0,t.jsx)(i.p,{children:"Proposals have several states and features:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Can be created by any authorized signer"}),"\n",(0,t.jsx)(i.li,{children:"Remain active until executed, rejected, expired or invalidated"}),"\n",(0,t.jsx)(i.li,{children:"May have optional expiration times"}),"\n"]}),"\n",(0,t.jsx)(i.h4,{id:"proposal-states",children:"Proposal States"}),"\n",(0,t.jsx)(i.p,{children:"A proposal can be in one of the following states:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Active"}),": Currently collecting approvals, not yet executed"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Expired"}),": Passed its expiration time without sufficient approvals"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Failed"}),": Execution was complete but the transaction failed"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Invalid"}),": No longer valid due to configuration changes"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Successful"}),": Successfully executed"]}),"\n"]}),"\n",(0,t.jsxs)(i.admonition,{title:"Invalid Proposals",type:"note",children:[(0,t.jsx)(i.p,{children:"The following situations will cause proposals to be invalidated."}),(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Configuration changes (modifying signers or required signatures) invalidate all pending proposals"}),"\n",(0,t.jsx)(i.li,{children:"Removal of a multisig account from an identity"}),"\n",(0,t.jsx)(i.li,{children:"A chain upgrade containing breaking transaction changes"}),"\n"]}),(0,t.jsx)(i.p,{children:"Invalidated proposals must be recreated as new proposals if required."})]}),"\n",(0,t.jsx)(i.admonition,{type:"note",children:(0,t.jsxs)(i.p,{children:["Historical proposal details can be retrieved via the ",(0,t.jsx)(i.a,{href:"/development/tooling/subquery",children:"SubQuery"})," chain indexing service or by querying historical blocks on an archive node."]})})]})}function h(e={}){const{wrapper:i}={...(0,a.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,i,n)=>{n.d(i,{R:()=>r,x:()=>o});var s=n(96540);const t={},a=s.createContext(t);function r(e){const i=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(a.Provider,{value:i},e.children)}}}]);