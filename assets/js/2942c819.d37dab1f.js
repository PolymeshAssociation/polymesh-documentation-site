"use strict";(self.webpackChunkpolymesh_developer_documentation=self.webpackChunkpolymesh_developer_documentation||[]).push([[89789],{28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>r});var t=i(96540);const s={},a=t.createContext(s);function o(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(a.Provider,{value:n},e.children)}},37771:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"core-concepts/confidential-assets/confidential-assets-onboarding-accounts","title":"Onboarding & Confidential Accounts","description":"Off-chain key generation and on-chain registration for confidential accounts","source":"@site/docs/200-core-concepts/090-confidential-assets/020-onboarding-and-accounts.mdx","sourceDirName":"200-core-concepts/090-confidential-assets","slug":"/confidential-assets/onboarding-accounts","permalink":"/polymesh-documentation-site/confidential-assets/onboarding-accounts","draft":false,"unlisted":false,"editUrl":"https://github.com/PolymeshAssociation/polymesh-documentation-site/edit/develop/docs/200-core-concepts/090-confidential-assets/020-onboarding-and-accounts.mdx","tags":[],"version":"current","sidebarPosition":20,"frontMatter":{"title":"Onboarding & Confidential Accounts","description":"Off-chain key generation and on-chain registration for confidential accounts","sidebar_label":"Onboarding & Accounts","slug":"/confidential-assets/onboarding-accounts","id":"confidential-assets-onboarding-accounts"},"sidebar":"docs","previous":{"title":"Architecture","permalink":"/polymesh-documentation-site/confidential-assets/architecture"},"next":{"title":"Asset Operations","permalink":"/polymesh-documentation-site/confidential-assets/asset-operations"}}');var s=i(74848),a=i(28453);const o={title:"Onboarding & Confidential Accounts",description:"Off-chain key generation and on-chain registration for confidential accounts",sidebar_label:"Onboarding & Accounts",slug:"/confidential-assets/onboarding-accounts",id:"confidential-assets-onboarding-accounts"},r="Onboarding & Confidential Accounts",c={},l=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Keys and Deterministic Randomness",id:"keys-and-deterministic-randomness",level:2},{value:"Lifecycle: Off-chain \u2192 On-chain",id:"lifecycle-off-chain--on-chain",level:2},{value:"1) Off-chain: Generate keys and initialize prover",id:"1-off-chain-generate-keys-and-initialize-prover",level:3},{value:"2) On-chain: Register confidential account (identity link)",id:"2-on-chain-register-confidential-account-identity-link",level:3},{value:"3) On-chain: Register for a specific asset (asset-specific state)",id:"3-on-chain-register-for-a-specific-asset-asset-specific-state",level:3},{value:"4) On-chain: State transitions (ongoing use)",id:"4-on-chain-state-transitions-ongoing-use",level:3},{value:"Recovery and Ledger Scanning",id:"recovery-and-ledger-scanning",level:2},{value:"Best Practices",id:"best-practices",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"onboarding--confidential-accounts",children:"Onboarding & Confidential Accounts"})}),"\n",(0,s.jsx)(n.p,{children:"This page explains the protocol-level steps to create and use confidential accounts on Polymesh. It focuses on what you do off-chain (generate keys, initialize your prover) and what you do on-chain (register, update state), so readers can apply the concepts in any application or wallet."}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsx)(n.p,{children:"Before you register a confidential account, you need:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"A Polymesh signing key and DID (to submit transactions)"}),"\n",(0,s.jsx)(n.li,{children:"Access to a proof service (e.g., a WASM library or remote prover)"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"keys-and-deterministic-randomness",children:"Keys and Deterministic Randomness"}),"\n",(0,s.jsx)(n.p,{children:"Every confidential account relies on two key pairs and deterministically derived randomness. The keys establish identity and encrypt payloads; the randomness binds state transitions and enables recovery."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Account key:"})," Proves ownership inside zero-knowledge proofs and deterministically derives nullifiers for spent states."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Encryption key:"})," Encrypts settlement leg details so only authorized parties (sender, receiver, auditors, mediators) can read them."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"PRF-derived randomness values:"})," Derived from the account secret key plus public asset context (identity, asset id, and registration counter) to seed the initial per-asset randomness. After seeding, randomness advances deterministically on each state transition. It blinds commitments and produces nullifiers in a way that can be reconstructed later if local state is lost."]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"Pseudorandom Function (PRF): a deterministic function keyed by the confidential account secret key that outputs values indistinguishable from random; used to derive the initial per-asset randomness. Subsequent randomness values are derived deterministically from the previous one."})}),"\n",(0,s.jsx)(n.h2,{id:"lifecycle-off-chain--on-chain",children:"Lifecycle: Off-chain \u2192 On-chain"}),"\n",(0,s.jsx)(n.p,{children:"At a high level, you first set up keys off-chain, then establish your confidential account on-chain, then register asset-specific state, and finally perform private state transitions as you transact."}),"\n",(0,s.jsx)(n.h3,{id:"1-off-chain-generate-keys-and-initialize-prover",children:"1) Off-chain: Generate keys and initialize prover"}),"\n",(0,s.jsx)(n.p,{children:"Generate your account and encryption keys, then load them into your proof service."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Generate the account public/secret key and the encryption public/secret key."}),"\n",(0,s.jsx)(n.li,{children:"Initialize the proof service with keys; you may also pre-derive the initial per-asset randomness if you already know which asset you'll register."}),"\n",(0,s.jsx)(n.li,{children:"Store keys securely (hardware wallet, secure enclave, or encrypted vault)."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2-on-chain-register-confidential-account-identity-link",children:"2) On-chain: Register confidential account (identity link)"}),"\n",(0,s.jsx)(n.p,{children:"Prove ownership of your account key and link it to your DID. This establishes your confidential identity on the chain."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Produce a ",(0,s.jsx)(n.strong,{children:"registration proof"})," showing ownership of your account public key."]}),"\n",(0,s.jsxs)(n.li,{children:["Submit ",(0,s.jsx)(n.code,{children:"registerAccounts"})," with the proof to link the account and encryption key to your DID."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-on-chain-register-for-a-specific-asset-asset-specific-state",children:"3) On-chain: Register for a specific asset (asset-specific state)"}),"\n",(0,s.jsx)(n.p,{children:"Create the asset-specific on-chain state for your account. One key can register many assets; each asset has its own independent state commitment. The initial state has balance = 0 and in-flight transaction counter = 0, with randomness seeded via the PRF."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Produce a ",(0,s.jsx)(n.strong,{children:"register-account-asset proof"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Submit ",(0,s.jsx)(n.code,{children:"registerAccountAssets"}),"; the chain records an initial zero-balance commitment for that asset under your account key."]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"One key can register multiple assets; each asset has an independent on-chain state commitment"})}),"\n",(0,s.jsx)(n.h3,{id:"4-on-chain-state-transitions-ongoing-use",children:"4) On-chain: State transitions (ongoing use)"}),"\n",(0,s.jsx)(n.p,{children:"When you transact, the old state is consumed and a new commitment is published. Validators verify the proofs without learning private values."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Reveal a deterministic ",(0,s.jsx)(n.strong,{children:"nullifier"})," for the old state (prevents double-spend)."]}),"\n",(0,s.jsxs)(n.li,{children:["Publish a new ",(0,s.jsx)(n.strong,{children:"state commitment"})," (updated balance and transaction counter) to the curve-tree accumulator."]}),"\n",(0,s.jsxs)(n.li,{children:["Most updates occur via the settlement flows; see ",(0,s.jsx)(n.a,{href:"/confidential-assets/settlement-workflow",children:"Settlement Workflow"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"recovery-and-ledger-scanning",children:"Recovery and Ledger Scanning"}),"\n",(0,s.jsx)(n.p,{children:"If you lose local state, deterministic randomness lets you rebuild it from the ledger."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Recompute the initial per-asset randomness from your secret key and asset context (identity, asset id, and registration counter), then step it forward deterministically for each transition."}),"\n",(0,s.jsx)(n.li,{children:"Scan the chain for involved transactions, matching nullifiers/commitments and rebuild your local state timeline."}),"\n",(0,s.jsx)(n.li,{children:"Decrypt relevant leg payloads with your encryption secret key when visibility is needed."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsx)(n.p,{children:"Practical tips to keep operations smooth and private:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Keep your account and encryption secret keys separate from the Polymesh signing key used to submit transactions."}),"\n",(0,s.jsx)(n.li,{children:"Maintain secure backups of keys and the minimal context needed to recompute randomness (secret key and asset identifiers); avoid storing decrypted seeds on disk."}),"\n",(0,s.jsx)(n.li,{children:"Cache latest state commitments locally, updating after successful on-chain transactions; periodically verify against curve-tree roots."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"For asset creation/mint and settlement details, see:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/confidential-assets/asset-operations",children:"Asset Operations"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/confidential-assets/settlement-workflow",children:"Settlement Workflow"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);